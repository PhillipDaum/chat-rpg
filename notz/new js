//Welcome messages
function welcomeTo() {
    let wMessage = document.createElement('h2');  
        wMessage.textContent = welcome[Math.floor(Math.random() * welcome.length)];
        wMessage.className = "text-info font-monospace";
        wMessage.id = "change";

    //uptates HTML DOM
    document.getElementById("chatloggy").appendChild(wMessage);

    //genereates random user avatar
    document.getElementById('username').textContent = userName[Math.floor(Math.random() * userName.length)];

    //user input text area is ready to by typed in
    document.getElementById('input').focus();
}


//Makes enter key work
document.getElementById('input').addEventListener('keydown', function(event) {
    if (event.keyCode == 13) {
        let userInput = document.getElementById("input").textContent;
        chatBot(userInput);
    }
})


//switches if then statement from RPG convo and debug
const switchRpg = [
    "undefined[object HTMLInputElement]",
    "Invalid command!",
    "undefined",
]


//comparing function for matching user input with response
function compare(a, b, c) { 
    for (let x = 0; x < a.length; x++) {
        for (let y = 0; y < b.length; y++){
          if (a[x][y] == c) {
            let replies = b[x];
            let reply = replies[Math.floor(Math.random() * replies.length)];
            return reply;
          }
        }
    }
}


// main chat function
function chatBot(a) {

    //I feel like I shouldnt need this
    let reUserInput = document.getElementById("input").textContent;

    //remove all characters except word characters, space, and digits    
    let text = a.toLowerCase().replace(/[^\w\s]/gi, "").replace(/[\d]/gi, "").trim();
        text = text
            .replace(/ a /g, " ")   // replaces 'tell me a story' to 'tell me story'
            .replace(/i feel /g, "")
            .replace(/whats/g, "what is") // replaces "whats" to "what is"
            .replace(/please /g, "")
            .replace(/ please/g, "")
            .replace(/r u/g, "are you"); //replaces "r u" to "are you";

    //makes username print also when DOM updates
    let avatar = document.getElementById("username").textContent;
    let finalUser = avatar + reUserInput;

    //uptates HTML DOM with user input and username
    let parUser = document.createElement('h2');  
    parUser.textContent = finalUser;
    parUser.className = "text-success"
    document.getElementById("chatloggy").appendChild(parUser);

    console.log("poop");

    //matches user input with response
    if (includes(text)) { 
        //first searches for links by keyword       
        key = includes(text);
        console.log(key);
        finalResult = compare(userTexts, botReplies, key);
    } else {
       
            if (compare(userTexts, botReplies, text)) { 
                    // next it will do basic Chat script arrays
                    finalResult = compare(userTexts, botReplies, text);
                } else {
                    // if everything else fails, bot produces a random alternative reply
                    finalResult = alternative[Math.floor(Math.random() * alternative.length)];
                }
            }
                   

    //uptates HTML DOM 
    let parBot = document.createElement('div')  
    parBot.innerHTML = finalResult;
    parBot.className = "text-info p-5 fs-3 font-monospace lh-sm";
    document.getElementById("chatloggy").appendChild(parBot);

    //removes text after they hit enter
    document.getElementById("input").value = "";

    //keeps input in view needs to work on mobile too
    document.getElementById('username').scrollIntoView(true);

    //deletes welcome message
    document.getElementById('change').textContent = "";
} 







