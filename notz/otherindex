

//gets text element to append
const textElement = document.getElementById('text')
const optionButtonsElement = document.getElementById('option-buttons')

//users current game state
let state = {}

//makes game go, shows state from text node they are in
function startGame() {
  state = {}
  showTextNode(1)
}

//shows the textnode they are in
//shows 
function showTextNode(textNodeIndex) {
    //this chooses what text to show based on directory
  const textNode = textNodes.find(textNode => textNode.id === textNodeIndex)
  textElement.innerText = textNode.text
  //this sends and removes the whole element
  //appends the document
  while (optionButtonsElement.firstChild) {
    optionButtonsElement.removeChild(optionButtonsElement.firstChild)
  }


  //writes the text on each button
  textNode.options.forEach(option => {
    if (showOption(option)) {
      const button = document.createElement('button')
      button.innerText = option.text
      button.classList.add('btn')
      button.addEventListener('click', () => selectOption(option))
      optionButtonsElement.appendChild(button)
    }
  })
}


//this returns the state or the nothing maybe
function showOption(option) {
  return option.requiredState == null || option.requiredState(state)
}


//can return user to the start of the game if nextText is less than 0
//otherwise, it defines the state
function selectOption(option) {
  const nextTextNodeId = option.nextText
  if (nextTextNodeId <= 0) {
    return startGame()
  }
  state = Object.assign(state, option.setState)
  showTextNode(nextTextNodeId)
}




startGame()